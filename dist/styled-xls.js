!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["styled-xls"]=t():e["styled-xls"]=t()}(global,(function(){return(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e.r(t),e.d(t,{createBook:()=>w,createBookURI:()=>D,createFromObjectArray:()=>C,createFromObjectArrayTest:()=>T,createFromObjectArrayURI:()=>A});const r=function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l="<Row>",a=0;a<e.length;a++){var s=e[a],i=(new Date).getTime();if(s.style&&r(i,s.style),"object"!==o(s)||Array.isArray(s)||null===s)"string"==typeof s?(l+='<Cell ss:MergeDown="'+(n||"0")+'" ss:StyleID="'+t+'"><Data ss:Type="String">',l+=s,l+="</Data></Cell>"):"number"==typeof s&&(l+='<Cell ss:MergeDown="'+(n||"0")+'" ss:StyleID="'+t+(s%1==0?"int":"float")+'"><Data ss:Type="Number">',l+=s,l+="</Data></Cell>");else{var c=s.element;if(s.type){if("formula"==s.type){var u="String";!s.outputType||"float"!==s.outputType&&"int"!==s.outputType||(u="Number"),l+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+s.outputType+'" ss:Formula="'+(c||s.formula||"")+'"><Data ss:Type="'+u+'">'}else"float"==s.type?(l+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'float"><Data ss:Type="Number">',l+=c):"number"==s.type||"int"==s.type?(l+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'int"><Data ss:Type="Number">',l+=c):(l+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',l+=c);l+="</Data></Cell>"}else"object"===o(s)&&(l+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',l+=c,l+="</Data></Cell>")}}l+="</Row>";for(var f=0;f<n;f++)l+="<Row>",l+="</Row>";return l},n=function(e,t,o,r,n){var l='<Worksheet ss:Name="'.concat(e,'">\n  <Names>\n  <NamedRange ss:Name="Sheet_Titles" ss:RefersTo="=\'').concat(e,'\'!R1:R2">\n  </NamedRange></Names>\n  <Table ss:ExpandedColumnCount="').concat(t+2,'" ss:ExpandedRowCount="').concat(o,'" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="80" ss:DefaultRowHeight="15">\n  ').concat(r);return n&&(l+=n),l};var l='</Table>\n<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n<PageLayoutZoom>0</PageLayoutZoom>\n<Selected/>\n<Panes>\n<Pane>\n<Number>3</Number>\n<ActiveRow>2</ActiveRow>\n</Pane>\n</Panes>\n<ProtectObjects>False</ProtectObjects>\n<ProtectScenarios>False</ProtectScenarios>\n</WorksheetOptions>\n</Worksheet>';const a=function(e,t,o){var a="",s=0,i=0;if(e&&Array.isArray(e)&&e.length>0){var c=e[0];s=c.length;for(var u=0;u<c.length;u++)c[u]&&(i+=90,a+='<Column ss:AutoFitWidth="1" ss:Width="90" />')}for(var f={height:9e3,width:Math.floor(30*i)+50},y=e.length+2,m=n(t,s,y,a),d=0;d<e.length;d++){var p=d%2==1?"zebra":"normal",h=e[d];h.style&&o("row"+d,h.style),m+=h&&h.elements?r(h.elements,h.style?"row"+d:p,o,h.rowSpan):r(h,p)}return f.xml=m+l,f},s=function(e,t,o){var r="<Row>";if(t)for(var n=0;n<t.length;n++){var l=t[n],a=e[l.key];if(l.type){if("formula"==l.type){var s="String";!l.outputType||"float"!==l.outputType&&"int"!==l.outputType||(s="Number"),r+='<Cell ss:StyleID="'+(l.columnStyle?(l.key||"")+"ColumnCell":o)+l.outputType+'" ss:Formula="'+(a||l.formula||"")+'"><Data ss:Type="'+s+'">'}else"float"==l.type?(r+='<Cell ss:StyleID="'+(l.columnStyle?(l.key||"")+"ColumnCell":o)+'float"><Data ss:Type="Number">',r+=a):"number"==l.type||"int"==l.type?(r+='<Cell ss:StyleID="'+(l.columnStyle?(l.key||"")+"ColumnCell":o)+'int"><Data ss:Type="Number">',r+=a):(r+='<Cell ss:StyleID="'+(l.columnStyle?(l.key||"")+"ColumnCell":o)+'"><Data ss:Type="String">',r+=a);r+="</Data></Cell>"}}else for(var i=Object.keys(e),c=0;c<i.length;c++){var u=e[i[c]];"number"==typeof u?(r+='<Cell ss:StyleID="'+o+(u%1==0?"int":"float")+'"><Data ss:Type="Number">',r+=u,r+="</Data></Cell>"):(r+='<Cell ss:StyleID="'+o+'"><Data ss:Type="String">',r+=u,r+="</Data></Cell>")}return r+"</Row>"};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}const c=function(e,t,o,a,c,u){var f='<Row ss:AutoFitHeight="1">',y=0,m=0,d="";if(o){y=o.length;for(var p=0;p<o.length;p++){var h=o[p];if(h){var S=h.width;m+=S,h.headerStyle&&a((h.key||"")+"ColumnHeader",h.headerStyle),h.columnStyle&&a((h.key||"")+"ColumnCell",h.columnStyle),""===h.displayName||(d+='<Column ss:AutoFitWidth="1" ss:Width="'+S+'" />',f+='<Cell ss:StyleID="'.concat(h.headerStyle?(h.key||"")+"ColumnHeader":"headercell",'">')+'<Data ss:Type="String">'+h.displayName+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}}else if(e&&Array.isArray(e)&&e.length>0){var g=Object.keys(e[0]);y=g.length;for(var b=0;b<g.length;b++){var v=g[b];v&&(m+=90,d+='<Column ss:AutoFitWidth="1" ss:Width="90" />',f+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+v+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}f+="</Row>",Array.isArray(u)&&u.forEach((function(e,t){if("object"===i(e)){var o=e.style;a("firstRow"+t,o);var n=r(e.elements,e.style?"firstRow"+t:"normal",a);f=n+f}else{var l=r(e,"normal",a);f=l+f}}));var C={height:9e3,width:Math.floor(30*m)+50},w=e.length+2;c&&w++,u&&(w+=u.length);for(var A=n(t,y,w,d,f),D=0;D<e.length;D++){var T=D%2==1?"zebra":"normal",x=e[D];A+=s(x,o,T)}if(c&&c.elements){var N=c.style;a("lastRow",N),A+=r(c.elements,c.style?"lastRow":"normal",a)}return C.xml=A+l,C},u=function(e,t,o,r,n,l,a,s,i){var c,u,f,y,m,d,p,h,S,g,b=[];if(b.push('<Style ss:ID="'.concat(e,'" ').concat(t?'ss:Parent="'+t+'"':"").concat(i?' ss:Name="'+i+'"':"",">")),n){var v=function(e){return"<Numberformat".concat(void 0===e||"empty"===e?"":' ss:Format="'+e+'"',"/>")}(n);b.push(v)}if(o){var C=(c=o.name,u=o.family,f=o.weight,y=o.size,m=o.color,"<Font ".concat(void 0===c?"":' ss:FontName="'+(c||"Calibri")+'"').concat(void 0===u?"":' x:Family="'+(u||"Swiss")+'"').concat(void 0===f?"":' ss:Bold="'+(f||"0")+'"').concat(void 0===y?"":' ss:Size="'+(y||"10")+'"').concat(void 0===m?"":' ss:Color="'+(m||"ffffff")+'"',"/>"));b.push(C)}if(a){var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Left","Right","Bottom","Top"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];return r.push("<Borders>"),e&&Array.isArray(e)&&e.forEach((function(e){r.push('<Border ss:Position="'.concat(e,'" ss:LineStyle="Continuous"  ss:Color="').concat(t[e]&&t[e].color||t.color||o.color||"#ffffff",'" ss:Weight="').concat(t[e]&&t[e].weight||t.weight||o.weight||"1",'"/>'))})),r.push("</Borders>"),r}(a.type,a.styles);b.push.apply(b,w)}if(l){var A=(d=l.vertical,p=l.horizontal,h=l.wrapText,"<Alignment".concat(d?' ss:Vertical="'+(d||"Center")+'"':"").concat(p?' ss:Horizontal="'+(p||"Center")+'"':"").concat(h?' ss:WrapText="'+(h||"1")+'"':"","/>"));b.push(A)}if(r){var D=(S=r.color,g=r.pattern,"<Interior".concat(void 0===S?"":' ss:Color="'+(S||"#ffffff")+'"').concat(void 0===g?"":' ss:Pattern="'+(g||"Solid")+'"',"/>"));b.push(D)}if(s){b.push("<Protection/>")}return b.push("</Style>"),b},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()};function y(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?m(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}const d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{defaultStyle:{},headerStyle:{}},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o={name:e.defaultStyle.fontName,family:e.defaultStyle.fontFamily,weight:e.defaultStyle.fontWeight,size:e.defaultStyle.fontSize,color:e.defaultStyle.fontColor},r={weight:"1",size:"18"},n={name:"Calibri",family:"Swiss",color:"#000000",size:"12"},l={color:e.alternateRowColor||e.defaultStyle.backgroundColor,pattern:"Solid"},a={color:e.defaultStyle.backgroundColor,pattern:"Solid"},s={},i={vertical:"Center",horizontal:"Center",wrapText:"1"},c={color:"#D3D3D3"},m={vertical:"Bottom"},d={type:[]},p={type:["Top","Bottom","Right","Left"],styles:{color:e.defaultStyle.borderColor||"#000000"}},h=u("normalint","normal",null,null,"0"),S=u("normalfloat","normal",null,null,"0.00"),g=u("normaldate","normal",null,null,"yyyy-mm-dd"),b=u("zebraint","zebra",null,null,"0"),v=u("zebrafloat","zebra",null,null,"0.00"),C=u("zebradate","zebra",null,null,"yyyy-mm-dd"),w=u("zebra",null,o,l,null,null,p),A=u("normal",null,o,a,null,null,p),D=u("groupSeparator",null,null,c),T=u("title",null,r,s,"@",i,d),x=u("Default",null,n,s,"empty",m,d,!0,"Normal"),N=[].concat(y(x),y(T),y(A),y(g),y(h),y(S),y(w),y(D),y(C),y(b),y(v));if(t){var k={type:["Top","Bottom","Right","Left"],styles:{color:e.headerStyle.borderColor||"#000000"}},R={name:e.headerStyle.fontName,family:e.headerStyle.fontFamily,weight:e.headerStyle.fontWeight,size:e.headerStyle.fontSize,color:e.headerStyle.fontColor},z={color:e.headerStyle.backgroundColor||"#A3C9F1",pattern:"Solid"},W={horizontal:e.headerStyle.horizontalAlignment?f(e.headerStyle.horizontalAlignment):null,wrapText:e.headerStyle.wrapText||"1"},I=u("headercell",null,R,z,null,W,k);N.push.apply(N,I)}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o={name:t.fontName,family:t.fontFamily,weight:t.fontWeight,size:t.fontSize,color:t.color||t.fontColor},r={color:t.backgroundColor||"#A3C9F1",pattern:t.pattern||"Solid"},n={type:["Top","Bottom","Right","Left"],styles:{color:t.borderColor||"#000000"}},l={vertical:t.verticalAlignment?f(t.verticalAlignment):null,horizontal:t.horizontalAlignment?f(t.horizontalAlignment):null,wrapText:t.wrapText},a=u(e,null,o,r,null,l,n),s=u(e+"int",e,null,null,"0"),i=u(e+"float",e,null,null,"0.00"),c=u(e+"date",e,null,null,"yyyy-mm-dd"),m=[].concat(y(a),y(s),y(i),y(c));Array.isArray(N)&&N.push.apply(N,m)}return{styles:N,addStyle:P}};function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function h(e){var t,o;return(t="<Styles>").concat.apply(t,(o=e,function(e){if(Array.isArray(e))return p(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?p(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["</Styles>"]))}const S=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{defaultStyle:{},headerStyle:{}},r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=d(o,!s),u=s?a(t,e,i.addStyle):c(t,e,r,i.addStyle,l,n),f='<?xml version="1.0"?>\n  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'.concat(e,'</Title></DocumentProperties>\n  <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>\n  <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n  <WindowHeight>').concat(u.height,"</WindowHeight>\n  <WindowWidth>").concat(u.width,"</WindowWidth>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n  </ExcelWorkbook>"),y=h(i.styles),m=f+y+u.xml+"</Workbook>";return m},g=function(e,t){for(var o=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(o.length),l=new Uint8Array(n),a=0;a<o.length;a++)l[a]=o.charCodeAt(a);return new Blob([n],{type:t||r})};var b={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,o,r,n,l,a,s,i="",c=0;for(e=b._utf8_encode(e);c<e.length;)n=(t=e.charCodeAt(c++))>>2,l=(3&t)<<4|(o=e.charCodeAt(c++))>>4,a=(15&o)<<2|(r=e.charCodeAt(c++))>>6,s=63&r,isNaN(o)?a=s=64:isNaN(r)&&(s=64),i=i+this._keyStr.charAt(n)+this._keyStr.charAt(l)+this._keyStr.charAt(a)+this._keyStr.charAt(s);return i},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var r=e.charCodeAt(o);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}};const v=b,C=function(e,t,o,r,n,l){var a=S(e,t,o,r,n,l),s=v.encode(a);return g("data:application/vnd.ms-excel;base64,"+s)},w=function(e,t,o){var r=S(e,t,{defaultStyle:o},null,null,null,!0),n=v.encode(r);return g("data:application/vnd.ms-excel;base64,"+n)},A=function(e,t,o,r,n,l){var a=S(e,t,o,r,n,l);return"data:application/vnd.ms-excel;base64,"+Buffer.from(a).toString("base64")},D=function(e,t,o){var r=S(e,t,{defaultStyle:o},null,null,null,!0);return"data:application/vnd.ms-excel;base64,"+Buffer.from(r).toString("base64")},T=function(e,t,o,r,n,l){var a=S(e,t,o,r,n,l),s=v.encode(a);return{blob:g("data:application/vnd.ms-excel;base64,"+s,"application/vnd.ms-excel;base64"),book:a,dataURI:s}};return t})()}));