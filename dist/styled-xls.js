!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["styled-xls"]=t():e["styled-xls"]=t()}(global,(function(){return(()=>{"use strict";var e={d:(t,o)=>{for(var l in o)e.o(o,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:o[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e.r(t),e.d(t,{createBook:()=>w,createFromObjectArray:()=>S});const l=function(e,t,l){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;console.log("currentRow",e,"rowSpan",n);for(var r="<Row>",a=0;a<e.length;a++){var s=e[a],i=(new Date).getTime();if(console.log("currentColumn",s),s.style&&l(i,s.style),"object"!==o(s)||Array.isArray(s)||null===s)"string"==typeof s?(r+='<Cell ss:MergeDown="'+(n||"0")+'" ss:StyleID="'+t+'"><Data ss:Type="String">',r+=s,r+="</Data></Cell>"):"number"==typeof s&&(r+='<Cell ss:MergeDown="'+(n||"0")+'" ss:StyleID="'+t+(s%1==0?"int":"float")+'"><Data ss:Type="Number">',r+=s,r+="</Data></Cell>");else{var c=s.element;s.type?(console.log("currentColumn",s,"currentColumn.rowSpan",s.rowSpan,"rowSpan",n),"formula"==s.type?r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+s.outputType+'" ss:Formula="'+(c||s.formula||"")+'"><Data ss:Type="Formula">':"float"==s.type?(r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'float"><Data ss:Type="Number">',r+=c):"number"==s.type||"int"==s.type?(r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'int"><Data ss:Type="Number">',r+=c):(r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',r+=c),r+="</Data></Cell>"):"object"===o(s)&&(console.log("currentColumn object",s),r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',r+=c,r+="</Data></Cell>",console.log("rowXml",r))}}r+="</Row>";for(var u=0;u<n;u++)r+="<Row>",r+="</Row>";return r},n=function(e,t,o,l,n){var r='<Worksheet ss:Name="'.concat(e,'">\n  <Names>\n  <NamedRange ss:Name="Sheet_Titles" ss:RefersTo="=\'').concat(e,'\'!R1:R2">\n  </NamedRange></Names>\n  <Table ss:ExpandedColumnCount="').concat(t+2,'" ss:ExpandedRowCount="').concat(o,'" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="80" ss:DefaultRowHeight="15">\n  ').concat(l);return n&&(r+=n),r};var r='</Table>\n<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n<PageLayoutZoom>0</PageLayoutZoom>\n<Selected/>\n<Panes>\n<Pane>\n<Number>3</Number>\n<ActiveRow>2</ActiveRow>\n</Pane>\n</Panes>\n<ProtectObjects>False</ProtectObjects>\n<ProtectScenarios>False</ProtectScenarios>\n</WorksheetOptions>\n</Worksheet>';const a=function(e,t,o){var a="",s=0,i=0;if(e&&Array.isArray(e)&&e.length>0){var c=e[0];s=c.length;for(var u=0;u<c.length;u++){var y=c[u];console.log("i",u),y&&(i+=90,console.log("totalWidth",i),a+='<Column ss:AutoFitWidth="1" ss:Width="90" />')}}for(var f={height:9e3,width:Math.floor(30*i)+50},m=e.length+2,p=n(t,s,m,a),d=0;d<e.length;d++){console.log("row",d);var h=d%2==1?"zebra":"default",g=e[d];g.style&&o("row"+d,g.style),p+=g&&g.elements?l(g.elements,g.style?"row"+d:h,o,g.rowSpan):l(g,h)}return f.xml=p+r,f},s=function(e,t,o){var l="<Row>";if(t)for(var n=0;n<t.length;n++){var r=t[n],a=e[r.key];r.type&&("formula"==r.type?l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+r.outputType+'" ss:Formula="'+(a||r.formula||"")+'"><Data ss:Type="Formula">':"float"==r.type?(l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+'float"><Data ss:Type="Number">',l+=a):"number"==r.type||"int"==r.type?(l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+'int"><Data ss:Type="Number">',l+=a):(l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+'"><Data ss:Type="String">',l+=a),l+="</Data></Cell>")}else for(var s=Object.keys(e),i=0;i<s.length;i++){var c=e[s[i]];"number"==typeof c?(l+='<Cell ss:StyleID="'+o+(c%1==0?"int":"float")+'"><Data ss:Type="Number">',l+=c,l+="</Data></Cell>"):(l+='<Cell ss:StyleID="'+o+'"><Data ss:Type="String">',l+=c,l+="</Data></Cell>")}return l+"</Row>"};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}const c=function(e,t,o,a,c,u){var y='<Row ss:AutoFitHeight="1">',f=0,m=0,p="";if(o){f=o.length;for(var d=0;d<o.length;d++){var h=o[d];if(console.log("i",d),console.log("currentHeader",h),h){var g=h.width;m+=g,console.log("totalWidth",m),h.headerStyle&&a((h.key||"")+"ColumnHeader",h.headerStyle),h.columnStyle&&a((h.key||"")+"ColumnCell",h.columnStyle),""===h.displayName?f--:(p+='<Column ss:AutoFitWidth="1" ss:Width="'+g+'" />',y+='<Cell ss:StyleID="'.concat(h.headerStyle?(h.key||"")+"ColumnHeader":"headercell",'">')+'<Data ss:Type="String">'+h.displayName+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}}else if(e&&Array.isArray(e)&&e.length>0){for(var S=Object.keys(e[0]),w=0;w<S.length;w++){var b=S[w];console.log("i",w),b&&(m+=90,console.log("totalWidth",m),p+='<Column ss:AutoFitWidth="1" ss:Width="90" />',y+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+b+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}console.log("keys",S)}y+="</Row>",Array.isArray(u)&&u.forEach((function(e,t){if("object"===i(e)){var o=e.style;a("firstRow"+t,o);var n=l(e.elements,e.style?"firstRow"+t:"default",a);y=n+y}else{var r=l(e,"default",a);y=r+y}}));for(var v={height:9e3,width:Math.floor(30*m)+50},C=e.length+2,D=n(t,f,C,p,y),A=0;A<e.length;A++){console.log("row",A);var T=A%2==1?"zebra":"default",x=e[A];D+=s(x,o,T)}if(c&&c.elements){var I=c.style;a("lastRow",I),D+=l(c.elements,c.style?"lastRow":"default",a)}return console.log("t",D),v.xml=D+r,v},u=function(e,t,o,l,n,r,a,s,i){var c,u,y,f,m,p,d,h,g,S,w=[];if(w.push('<Style ss:ID="'.concat(e,'" ').concat(t?'ss:Parent="'+t+'"':"").concat(i?' ss:Name="'+i+'"':"",">")),n){var b=function(e){return"<Numberformat".concat(void 0===e||"empty"===e?"":' ss:Format="'+e+'"',"/>")}(n);w.push(b)}if(o){var v=(c=o.name,u=o.family,y=o.weight,f=o.size,m=o.color,"<Font ".concat(void 0===c?"":' ss:FontName="'+(c||"Calibri")+'"').concat(void 0===u?"":' x:Family="'+(u||"Swiss")+'"').concat(void 0===y?"":' ss:Bold="'+(y||"0")+'"').concat(void 0===f?"":' ss:Size="'+(f||"10")+'"').concat(void 0===m?"":' ss:Color="'+(m||"ffffff")+'"',"/>"));w.push(v)}if(a){var C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Left","Right","Bottom","Top"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("borderStyles",t);var l=[];return l.push("<Borders>"),e&&Array.isArray(e)&&e.forEach((function(e){l.push('<Border ss:Position="'.concat(e,'" ss:LineStyle="Continuous"  ss:Color="').concat(t[e]&&t[e].color||t.color||o.color||"#ffffff",'" ss:Weight="').concat(t[e]&&t[e].weight||t.weight||o.weight||"1",'"/>'))})),l.push("</Borders>"),l}(a.type,a.styles);w.push.apply(w,C)}if(r){var D=(p=r.vertical,d=r.horizontal,h=r.wrapText,"<Alignment".concat(void 0===p?"":' ss:Vertical="'+(p||"Center")+'"').concat(void 0===d?"":' ss:Horizontal="'+(d||"Center")+'"').concat(void 0===h?"":' ss:WrapText="'+(h||"1")+'"',"/>"));w.push(D)}if(l){var A=(g=l.color,S=l.pattern,"<Interior".concat(void 0===g?"":' ss:Color="'+(g||"#ffffff")+'"').concat(void 0===S?"":' ss:Pattern="'+(S||"Solid")+'"',"/>"));w.push(A)}if(s){w.push("<Protection/>")}return w.push("</Style>"),w};function y(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}const m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{defaultStyle:{},headerStyle:{}},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o={name:e.defaultStyle.fontName,family:e.defaultStyle.fontFamily,weight:e.defaultStyle.fontWeight,size:e.defaultStyle.fontSize,color:e.defaultStyle.fontColor},l={weight:"1",size:"18"},n={name:"Calibri",family:"Swiss",color:"#000000",size:"12"},r={color:e.alternateRowColor||e.defaultStyle.backgroundColor,pattern:"Solid"},a={color:e.defaultStyle.backgroundColor,pattern:"Solid"},s={},i={vertical:"Center",horizontal:"Center",wrapText:"1"},c={color:"#D3D3D3"},f={vertical:"Bottom"},m={type:[]},p={type:["Top","Bottom","Right","Left"],styles:{color:e.defaultStyle.borderColor||"#000000"}},d=u("defaultint","default",null,null,"0"),h=u("defaultfloat","default",null,null,"0.00"),g=u("defaultdate","default",null,null,"yyyy-mm-dd"),S=u("zebraint","zebra",null,null,"0"),w=u("zebrafloat","zebra",null,null,"0.00"),b=u("zebradate","zebra",null,null,"yyyy-mm-dd"),v=u("zebra",null,o,r,null,null,p),C=u("default",null,o,a,null,null,p),D=u("groupSeparator",null,null,c),A=u("title",null,l,s,"@",i,m),T=u("Default",null,n,s,"empty",f,m,!0,"Normal"),x=[].concat(y(T),y(T),y(A),y(C),y(g),y(d),y(h),y(v),y(D),y(b),y(S),y(w));if(t){var I={type:["Top","Bottom","Right"],styles:{color:"#00FF00",Top:{color:"#FF0000",weight:"100"}}},W={name:e.headerStyle.fontName,family:e.headerStyle.fontFamily,weight:e.headerStyle.fontWeight,size:e.headerStyle.fontSize,color:e.headerStyle.fontColor},N={color:e.headerStyle.backgroundColor||"#A3C9F1",pattern:"Solid"},R={horizontal:e.headerStyle.horizontalAlignment||"Center",wrapText:e.headerStyle.wrapText||"1"},k=u("headercell",null,W,N,null,R,I);x.push.apply(x,k)}function F(e){var t={name:newstylesInp.fontName,family:newstylesInp.fontFamily,weight:newstylesInp.fontWeight,size:newstylesInp.fontSize,color:newstylesInp.color||newstylesInp.fontColor},o={color:newstylesInp.backgroundColor||"#A3C9F1",pattern:newstylesInp.pattern||"Solid"},l={type:["Top","Bottom","Right","Left"],styles:{color:newstylesInp.borderColor||"#000000"}},n={vertical:newstylesInp.verticalAlignment,horizontal:newstylesInp.horizontalAlignment,wrapText:newstylesInp.wrapText},r=u(e,null,t,o,null,n,l),a=u(e+"int",e,null,null,"0"),s=u(e+"float",e,null,null,"0.00"),i=u(e+"date",e,null,null,"yyyy-mm-dd"),c=[].concat(y(r),y(a),y(s),y(i));Array.isArray(x)&&x.push.apply(x,c)}return{styles:x,addStyle:F}};function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}function d(e){var t,o;return(t="<Styles>").concat.apply(t,(o=e,function(e){if(Array.isArray(e))return p(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?p(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["</Styles>"]))}const h=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=m(o,!s),u=s?a(t,e,i.addStyle):c(t,e,l,i.addStyle,r,n),y='<?xml version="1.0"?>\n  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'.concat(e,'</Title></DocumentProperties>\n  <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>\n  <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n  <WindowHeight>').concat(u.height,"</WindowHeight>\n  <WindowWidth>").concat(u.width,"</WindowWidth>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n  </ExcelWorkbook>"),f=d(i.styles),p=y+f+u.xml+"</Workbook>";return p},g=function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],l=new ArrayBuffer(t.length),n=new Uint8Array(l),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([l],{type:o})},S=function(e,t,o,l,n,r){var a=h(e,t,o,l,n,r),s=new Buffer(a).toString("base64");return g("data:application/vnd.ms-excel;base64,"+s)},w=function(e,t,o){var l=h(e,t,{defaultStyle:o},null,null,null,!0),n=new Buffer(l).toString("base64");return g("data:application/vnd.ms-excel;base64,"+n)};return t})()}));