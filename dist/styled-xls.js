!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["styled-xls"]=t():e["styled-xls"]=t()}(global,(function(){return(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e.r(t),e.d(t,{createBook:()=>C,createBookURI:()=>D,createFromObjectArray:()=>b,createFromObjectArrayURI:()=>w});const r=function(e,t,r){for(var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n="<Row>",a=0;a<e.length;a++){var s=e[a],i=(new Date).getTime();if(s.style&&r(i,s.style),"object"!==o(s)||Array.isArray(s)||null===s)"string"==typeof s?(n+='<Cell ss:MergeDown="'+(l||"0")+'" ss:StyleID="'+t+'"><Data ss:Type="String">',n+=s,n+="</Data></Cell>"):"number"==typeof s&&(n+='<Cell ss:MergeDown="'+(l||"0")+'" ss:StyleID="'+t+(s%1==0?"int":"float")+'"><Data ss:Type="Number">',n+=s,n+="</Data></Cell>");else{var c=s.element;s.type?("formula"==s.type?n+='<Cell ss:MergeDown="'+(s.rowSpan||l||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+s.outputType+'" ss:Formula="'+(c||s.formula||"")+'"><Data ss:Type="Formula">':"float"==s.type?(n+='<Cell ss:MergeDown="'+(s.rowSpan||l||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'float"><Data ss:Type="Number">',n+=c):"number"==s.type||"int"==s.type?(n+='<Cell ss:MergeDown="'+(s.rowSpan||l||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'int"><Data ss:Type="Number">',n+=c):(n+='<Cell ss:MergeDown="'+(s.rowSpan||l||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',n+=c),n+="</Data></Cell>"):"object"===o(s)&&(n+='<Cell ss:MergeDown="'+(s.rowSpan||l||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',n+=c,n+="</Data></Cell>")}}n+="</Row>";for(var u=0;u<l;u++)n+="<Row>",n+="</Row>";return n},l=function(e,t,o,r,l){var n='<Worksheet ss:Name="'.concat(e,'">\n  <Names>\n  <NamedRange ss:Name="Sheet_Titles" ss:RefersTo="=\'').concat(e,'\'!R1:R2">\n  </NamedRange></Names>\n  <Table ss:ExpandedColumnCount="').concat(t+2,'" ss:ExpandedRowCount="').concat(o,'" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="80" ss:DefaultRowHeight="15">\n  ').concat(r);return l&&(n+=l),n};var n='</Table>\n<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n<PageLayoutZoom>0</PageLayoutZoom>\n<Selected/>\n<Panes>\n<Pane>\n<Number>3</Number>\n<ActiveRow>2</ActiveRow>\n</Pane>\n</Panes>\n<ProtectObjects>False</ProtectObjects>\n<ProtectScenarios>False</ProtectScenarios>\n</WorksheetOptions>\n</Worksheet>';const a=function(e,t,o){var a="",s=0,i=0;if(e&&Array.isArray(e)&&e.length>0){var c=e[0];s=c.length;for(var u=0;u<c.length;u++)c[u]&&(i+=90,a+='<Column ss:AutoFitWidth="1" ss:Width="90" />')}for(var f={height:9e3,width:Math.floor(30*i)+50},y=e.length+2,m=l(t,s,y,a),d=0;d<e.length;d++){var p=d%2==1?"zebra":"default",h=e[d];h.style&&o("row"+d,h.style),m+=h&&h.elements?r(h.elements,h.style?"row"+d:p,o,h.rowSpan):r(h,p)}return f.xml=m+n,f},s=function(e,t,o){var r="<Row>";if(t)for(var l=0;l<t.length;l++){var n=t[l],a=e[n.key];n.type&&("formula"==n.type?r+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+n.outputType+'" ss:Formula="'+(a||n.formula||"")+'"><Data ss:Type="Formula">':"float"==n.type?(r+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'float"><Data ss:Type="Number">',r+=a):"number"==n.type||"int"==n.type?(r+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'int"><Data ss:Type="Number">',r+=a):(r+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'"><Data ss:Type="String">',r+=a),r+="</Data></Cell>")}else for(var s=Object.keys(e),i=0;i<s.length;i++){var c=e[s[i]];"number"==typeof c?(r+='<Cell ss:StyleID="'+o+(c%1==0?"int":"float")+'"><Data ss:Type="Number">',r+=c,r+="</Data></Cell>"):(r+='<Cell ss:StyleID="'+o+'"><Data ss:Type="String">',r+=c,r+="</Data></Cell>")}return r+"</Row>"};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}const c=function(e,t,o,a,c,u){var f='<Row ss:AutoFitHeight="1">',y=0,m=0,d="";if(o){y=o.length;for(var p=0;p<o.length;p++){var h=o[p];if(h){var S=h.width;m+=S,h.headerStyle&&a((h.key||"")+"ColumnHeader",h.headerStyle),h.columnStyle&&a((h.key||"")+"ColumnCell",h.columnStyle),""===h.displayName?y--:(d+='<Column ss:AutoFitWidth="1" ss:Width="'+S+'" />',f+='<Cell ss:StyleID="'.concat(h.headerStyle?(h.key||"")+"ColumnHeader":"headercell",'">')+'<Data ss:Type="String">'+h.displayName+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}}else if(e&&Array.isArray(e)&&e.length>0)for(var g=Object.keys(e[0]),v=0;v<g.length;v++){var b=g[v];b&&(m+=90,d+='<Column ss:AutoFitWidth="1" ss:Width="90" />',f+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+b+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}f+="</Row>",Array.isArray(u)&&u.forEach((function(e,t){if("object"===i(e)){var o=e.style;a("firstRow"+t,o);var l=r(e.elements,e.style?"firstRow"+t:"default",a);f=l+f}else{var n=r(e,"default",a);f=n+f}}));for(var C={height:9e3,width:Math.floor(30*m)+50},w=e.length+2,D=l(t,y,w,d,f),A=0;A<e.length;A++){var x=A%2==1?"zebra":"default",T=e[A];D+=s(T,o,x)}if(c&&c.elements){var N=c.style;a("lastRow",N),D+=r(c.elements,c.style?"lastRow":"default",a)}return C.xml=D+n,C},u=function(e,t,o,r,l,n,a,s,i){var c,u,f,y,m,d,p,h,S,g,v=[];if(v.push('<Style ss:ID="'.concat(e,'" ').concat(t?'ss:Parent="'+t+'"':"").concat(i?' ss:Name="'+i+'"':"",">")),l){var b=function(e){return"<Numberformat".concat(void 0===e||"empty"===e?"":' ss:Format="'+e+'"',"/>")}(l);v.push(b)}if(o){var C=(c=o.name,u=o.family,f=o.weight,y=o.size,m=o.color,"<Font ".concat(void 0===c?"":' ss:FontName="'+(c||"Calibri")+'"').concat(void 0===u?"":' x:Family="'+(u||"Swiss")+'"').concat(void 0===f?"":' ss:Bold="'+(f||"0")+'"').concat(void 0===y?"":' ss:Size="'+(y||"10")+'"').concat(void 0===m?"":' ss:Color="'+(m||"ffffff")+'"',"/>"));v.push(C)}if(a){var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Left","Right","Bottom","Top"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];return r.push("<Borders>"),e&&Array.isArray(e)&&e.forEach((function(e){r.push('<Border ss:Position="'.concat(e,'" ss:LineStyle="Continuous"  ss:Color="').concat(t[e]&&t[e].color||t.color||o.color||"#ffffff",'" ss:Weight="').concat(t[e]&&t[e].weight||t.weight||o.weight||"1",'"/>'))})),r.push("</Borders>"),r}(a.type,a.styles);v.push.apply(v,w)}if(n){var D=(d=n.vertical,p=n.horizontal,h=n.wrapText,"<Alignment".concat(void 0===d?"":' ss:Vertical="'+(d||"Center")+'"').concat(void 0===p?"":' ss:Horizontal="'+(p||"Center")+'"').concat(void 0===h?"":' ss:WrapText="'+(h||"1")+'"',"/>"));v.push(D)}if(r){var A=(S=r.color,g=r.pattern,"<Interior".concat(void 0===S?"":' ss:Color="'+(S||"#ffffff")+'"').concat(void 0===g?"":' ss:Pattern="'+(g||"Solid")+'"',"/>"));v.push(A)}if(s){v.push("<Protection/>")}return v.push("</Style>"),v};function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}const m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{defaultStyle:{},headerStyle:{}},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o={name:e.defaultStyle.fontName,family:e.defaultStyle.fontFamily,weight:e.defaultStyle.fontWeight,size:e.defaultStyle.fontSize,color:e.defaultStyle.fontColor},r={weight:"1",size:"18"},l={name:"Calibri",family:"Swiss",color:"#000000",size:"12"},n={color:e.alternateRowColor||e.defaultStyle.backgroundColor,pattern:"Solid"},a={color:e.defaultStyle.backgroundColor,pattern:"Solid"},s={},i={vertical:"Center",horizontal:"Center",wrapText:"1"},c={color:"#D3D3D3"},y={vertical:"Bottom"},m={type:[]},d={type:["Top","Bottom","Right","Left"],styles:{color:e.defaultStyle.borderColor||"#000000"}},p=u("defaultint","default",null,null,"0"),h=u("defaultfloat","default",null,null,"0.00"),S=u("defaultdate","default",null,null,"yyyy-mm-dd"),g=u("zebraint","zebra",null,null,"0"),v=u("zebrafloat","zebra",null,null,"0.00"),b=u("zebradate","zebra",null,null,"yyyy-mm-dd"),C=u("zebra",null,o,n,null,null,d),w=u("default",null,o,a,null,null,d),D=u("groupSeparator",null,null,c),A=u("title",null,r,s,"@",i,m),x=u("Default",null,l,s,"empty",y,m,!0,"Normal"),T=[].concat(f(x),f(x),f(A),f(w),f(S),f(p),f(h),f(C),f(D),f(b),f(g),f(v));if(t){var N={type:["Top","Bottom","Right"],styles:{color:"#00FF00",Top:{color:"#FF0000",weight:"100"}}},k={name:e.headerStyle.fontName,family:e.headerStyle.fontFamily,weight:e.headerStyle.fontWeight,size:e.headerStyle.fontSize,color:e.headerStyle.fontColor},R={color:e.headerStyle.backgroundColor||"#A3C9F1",pattern:"Solid"},F={horizontal:e.headerStyle.horizontalAlignment||"Center",wrapText:e.headerStyle.wrapText||"1"},W=u("headercell",null,k,R,null,F,N);T.push.apply(T,W)}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o={name:t.fontName,family:t.fontFamily,weight:t.fontWeight,size:t.fontSize,color:t.color||t.fontColor},r={color:t.backgroundColor||"#A3C9F1",pattern:t.pattern||"Solid"},l={type:["Top","Bottom","Right","Left"],styles:{color:t.borderColor||"#000000"}},n={vertical:t.verticalAlignment,horizontal:t.horizontalAlignment,wrapText:t.wrapText},a=u(e,null,o,r,null,n,l),s=u(e+"int",e,null,null,"0"),i=u(e+"float",e,null,null,"0.00"),c=u(e+"date",e,null,null,"yyyy-mm-dd"),y=[].concat(f(a),f(s),f(i),f(c));Array.isArray(T)&&T.push.apply(T,y)}return{styles:T,addStyle:z}};function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function p(e){var t,o;return(t="<Styles>").concat.apply(t,(o=e,function(e){if(Array.isArray(e))return d(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?d(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["</Styles>"]))}const h=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{defaultStyle:{},headerStyle:{}},r=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=m(o,!s),u=s?a(t,e,i.addStyle):c(t,e,r,i.addStyle,n,l),f='<?xml version="1.0"?>\n  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'.concat(e,'</Title></DocumentProperties>\n  <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>\n  <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n  <WindowHeight>').concat(u.height,"</WindowHeight>\n  <WindowWidth>").concat(u.width,"</WindowWidth>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n  </ExcelWorkbook>"),y=p(i.styles),d=f+y+u.xml+"</Workbook>";return d},S=function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),l=new Uint8Array(r),n=0;n<t.length;n++)l[n]=t.charCodeAt(n);return new Blob([r],{type:o})};var g={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,o,r,l,n,a,s,i="",c=0;for(e=g._utf8_encode(e);c<e.length;)l=(t=e.charCodeAt(c++))>>2,n=(3&t)<<4|(o=e.charCodeAt(c++))>>4,a=(15&o)<<2|(r=e.charCodeAt(c++))>>6,s=63&r,isNaN(o)?a=s=64:isNaN(r)&&(s=64),i=i+this._keyStr.charAt(l)+this._keyStr.charAt(n)+this._keyStr.charAt(a)+this._keyStr.charAt(s);return i},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var r=e.charCodeAt(o);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}};const v=g,b=function(e,t,o,r,l,n){var a=h(e,t,o,r,l,n),s=v.encode(a);return S("data:application/vnd.ms-excel;base64,"+s)},C=function(e,t,o){var r=h(e,t,{defaultStyle:o},null,null,null,!0),l=v.encode(r);return S("data:application/vnd.ms-excel;base64,"+l)},w=function(e,t,o,r,l,n){var a=h(e,t,o,r,l,n);return"data:application/vnd.ms-excel;base64,"+Buffer.from(a).toString("base64")},D=function(e,t,o){var r=h(e,t,{defaultStyle:o},null,null,null,!0);return"data:application/vnd.ms-excel;base64,"+Buffer.from(r).toString("base64")};return t})()}));