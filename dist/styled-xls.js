!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["styled-xls"]=t():e["styled-xls"]=t()}(global,(function(){return(()=>{"use strict";var e={d:(t,o)=>{for(var l in o)e.o(o,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:o[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e.r(t),e.d(t,{createBook:()=>S,createFromObjectArray:()=>g});const l=function(e,t,l){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;console.log("currentRow",e,"rowSpan",n);for(var r="<Row>",a=0;a<e.length;a++){var s=e[a],i=(new Date).getTime();if(console.log("currentColumn",s),s.style&&l(i,s.style),"object"!==o(s)||Array.isArray(s)||null===s)"string"==typeof s?(r+='<Cell ss:MergeDown="'+(n||"0")+'" ss:StyleID="'+t+'"><Data ss:Type="String">',r+=s,r+="</Data></Cell>"):"number"==typeof s&&(r+='<Cell ss:MergeDown="'+(n||"0")+'" ss:StyleID="'+t+(s%1==0?"int":"float")+'"><Data ss:Type="Number">',r+=s,r+="</Data></Cell>");else{var c=s.element;s.type?(console.log("currentColumn",s,"currentColumn.rowSpan",s.rowSpan,"rowSpan",n),"formula"==s.type?r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+s.outputType+'" ss:Formula="'+(c||s.formula||"")+'"><Data ss:Type="Formula">':"float"==s.type?(r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'float"><Data ss:Type="Number">',r+=c):"number"==s.type||"int"==s.type?(r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'int"><Data ss:Type="Number">',r+=c):(r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',r+=c),r+="</Data></Cell>"):"object"===o(s)&&(console.log("currentColumn object",s),r+='<Cell ss:MergeDown="'+(s.rowSpan||n||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',r+=c,r+="</Data></Cell>",console.log("rowXml",r))}}r+="</Row>";for(var u=0;u<n;u++)r+="<Row>",r+="</Row>";return r};var n='</Table>\n<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n<PageLayoutZoom>0</PageLayoutZoom>\n<Selected/>\n<Panes>\n<Pane>\n<Number>3</Number>\n<ActiveRow>2</ActiveRow>\n</Pane>\n</Panes>\n<ProtectObjects>False</ProtectObjects>\n<ProtectScenarios>False</ProtectScenarios>\n</WorksheetOptions>\n</Worksheet>';const r=function(e,t,o){var r="",a=0,s=0;if(e&&Array.isArray(e)&&e.length>0){var i=e[0];a=i.length;for(var c=0;c<i.length;c++){var u=i[c];console.log("i",c),u&&(s+=90,console.log("totalWidth",s),r+='<Column ss:AutoFitWidth="1" ss:Width="90" />')}}for(var y={height:9e3,width:Math.floor(30*s)+50},f=e.length+2,m=worksheetHeader(t,a,f,r),p=0;p<e.length;p++){console.log("row",p);var d=p%2==1?"zebra":"default",h=e[p];h.style&&o("row"+p,h.style),m+=h&&h.elements?l(h.elements,h.style?"row"+p:d,o,h.rowSpan):l(h,d)}return y.xml=m+n,y},a=function(e,t,o){var l="<Row>";if(t)for(var n=0;n<t.length;n++){var r=t[n],a=e[r.key];r.type&&("formula"==r.type?l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+r.outputType+'" ss:Formula="'+(a||r.formula||"")+'"><Data ss:Type="Formula">':"float"==r.type?(l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+'float"><Data ss:Type="Number">',l+=a):"number"==r.type||"int"==r.type?(l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+'int"><Data ss:Type="Number">',l+=a):(l+='<Cell ss:StyleID="'+(r.columnStyle?(r.key||"")+"ColumnCell":o)+'"><Data ss:Type="String">',l+=a),l+="</Data></Cell>")}else for(var s=Object.keys(e),i=0;i<s.length;i++){var c=e[s[i]];"number"==typeof c?(l+='<Cell ss:StyleID="'+o+(c%1==0?"int":"float")+'"><Data ss:Type="Number">',l+=c,l+="</Data></Cell>"):(l+='<Cell ss:StyleID="'+o+'"><Data ss:Type="String">',l+=c,l+="</Data></Cell>")}return l+"</Row>"};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}const i=function(e,t,o,r,i,c){var u='<Row ss:AutoFitHeight="1">',y=0,f=0,m="";if(o){y=o.length;for(var p=0;p<o.length;p++){var d=o[p];if(console.log("i",p),console.log("currentHeader",d),d){var h=d.width;f+=h,console.log("totalWidth",f),d.headerStyle&&r((d.key||"")+"ColumnHeader",d.headerStyle),d.columnStyle&&r((d.key||"")+"ColumnCell",d.columnStyle),""===d.displayName?y--:(m+='<Column ss:AutoFitWidth="1" ss:Width="'+h+'" />',u+='<Cell ss:StyleID="'.concat(d.headerStyle?(d.key||"")+"ColumnHeader":"headercell",'">')+'<Data ss:Type="String">'+d.displayName+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}}else if(e&&Array.isArray(e)&&e.length>0){for(var g=Object.keys(e[0]),S=0;S<g.length;S++){var w=g[S];console.log("i",S),w&&(f+=90,console.log("totalWidth",f),m+='<Column ss:AutoFitWidth="1" ss:Width="90" />',u+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+w+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}console.log("keys",g)}u+="</Row>",Array.isArray(c)&&c.forEach((function(e,t){if("object"===s(e)){var o=e.style;r("firstRow"+t,o);var n=l(e.elements,e.style?"firstRow"+t:"default",r);u=n+u}else{var a=l(e,"default",r);u=a+u}}));for(var b={height:9e3,width:Math.floor(30*f)+50},v=e.length+2,C=worksheetHeader(t,y,v,m,u),D=0;D<e.length;D++){console.log("row",D);var A=D%2==1?"zebra":"default",T=e[D];C+=a(T,o,A)}if(i&&i.elements){var x=i.style;r("lastRow",x),C+=l(i.elements,i.style?"lastRow":"default",r)}return console.log("t",C),b.xml=C+n,b},c=function(e,t,o,l,n,r,a,s,i){var c,u,y,f,m,p,d,h,g,S,w=[];if(w.push('<Style ss:ID="'.concat(e,'" ').concat(t?'ss:Parent="'+t+'"':"").concat(i?' ss:Name="'+i+'"':"",">")),n){var b=function(e){return"<Numberformat".concat(void 0===e||"empty"===e?"":' ss:Format="'+e+'"',"/>")}(n);w.push(b)}if(o){var v=(c=o.name,u=o.family,y=o.weight,f=o.size,m=o.color,"<Font ".concat(void 0===c?"":' ss:FontName="'+(c||"Calibri")+'"').concat(void 0===u?"":' x:Family="'+(u||"Swiss")+'"').concat(void 0===y?"":' ss:Bold="'+(y||"0")+'"').concat(void 0===f?"":' ss:Size="'+(f||"10")+'"').concat(void 0===m?"":' ss:Color="'+(m||"ffffff")+'"',"/>"));w.push(v)}if(a){var C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Left","Right","Bottom","Top"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("borderStyles",t);var l=[];return l.push("<Borders>"),e&&Array.isArray(e)&&e.forEach((function(e){l.push('<Border ss:Position="'.concat(e,'" ss:LineStyle="Continuous"  ss:Color="').concat(t[e]&&t[e].color||t.color||o.color||"#ffffff",'" ss:Weight="').concat(t[e]&&t[e].weight||t.weight||o.weight||"1",'"/>'))})),l.push("</Borders>"),l}(a.type,a.styles);w.push.apply(w,C)}if(r){var D=(p=r.vertical,d=r.horizontal,h=r.wrapText,"<Alignment".concat(void 0===p?"":' ss:Vertical="'+(p||"Center")+'"').concat(void 0===d?"":' ss:Horizontal="'+(d||"Center")+'"').concat(void 0===h?"":' ss:WrapText="'+(h||"1")+'"',"/>"));w.push(D)}if(l){var A=(g=l.color,S=l.pattern,"<Interior".concat(void 0===g?"":' ss:Color="'+(g||"#ffffff")+'"').concat(void 0===S?"":' ss:Pattern="'+(S||"Solid")+'"',"/>"));w.push(A)}if(s){w.push("<Protection/>")}return w.push("</Style>"),w};function u(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}const f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{defaultStyle:{},headerStyle:{}},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o={name:e.defaultStyle.fontName,family:e.defaultStyle.fontFamily,weight:e.defaultStyle.fontWeight,size:e.defaultStyle.fontSize,color:e.defaultStyle.fontColor},l={weight:"1",size:"18"},n={name:"Calibri",family:"Swiss",color:"#000000",size:"12"},r={color:e.alternateRowColor||e.defaultStyle.backgroundColor,pattern:"Solid"},a={color:e.defaultStyle.backgroundColor,pattern:"Solid"},s={},i={vertical:"Center",horizontal:"Center",wrapText:"1"},y={color:"#D3D3D3"},f={vertical:"Bottom"},m={type:[]},p={type:["Top","Bottom","Right","Left"],styles:{color:e.defaultStyle.borderColor||"#000000"}},d=c("defaultint","default",null,null,"0"),h=c("defaultfloat","default",null,null,"0.00"),g=c("defaultdate","default",null,null,"yyyy-mm-dd"),S=c("zebraint","zebra",null,null,"0"),w=c("zebrafloat","zebra",null,null,"0.00"),b=c("zebradate","zebra",null,null,"yyyy-mm-dd"),v=c("zebra",null,o,r,null,null,p),C=c("default",null,o,a,null,null,p),D=c("groupSeparator",null,null,y),A=c("title",null,l,s,"@",i,m),T=c("Default",null,n,s,"empty",f,m,!0,"Normal"),x=[].concat(u(T),u(T),u(A),u(C),u(g),u(d),u(h),u(v),u(D),u(b),u(S),u(w));if(t){var I={type:["Top","Bottom","Right"],styles:{color:"#00FF00",Top:{color:"#FF0000",weight:"100"}}},k={name:e.headerStyle.fontName,family:e.headerStyle.fontFamily,weight:e.headerStyle.fontWeight,size:e.headerStyle.fontSize,color:e.headerStyle.fontColor},W={color:e.headerStyle.backgroundColor||"#A3C9F1",pattern:"Solid"},z={horizontal:e.headerStyle.horizontalAlignment||"Center",wrapText:e.headerStyle.wrapText||"1"},F=c("headercell",null,k,W,null,z,I);allstylesInp.push.apply(x,F)}function P(e){var t={name:newstylesInp.fontName,family:newstylesInp.fontFamily,weight:newstylesInp.fontWeight,size:newstylesInp.fontSize,color:newstylesInp.color||newstylesInp.fontColor},o={color:newstylesInp.backgroundColor||"#A3C9F1",pattern:newstylesInp.pattern||"Solid"},l={type:["Top","Bottom","Right","Left"],styles:{color:newstylesInp.borderColor||"#000000"}},n={vertical:newstylesInp.verticalAlignment,horizontal:newstylesInp.horizontalAlignment,wrapText:newstylesInp.wrapText},r=c(e,null,t,o,null,n,l),a=c(e+"int",e,null,null,"0"),s=c(e+"float",e,null,null,"0.00"),i=c(e+"date",e,null,null,"yyyy-mm-dd"),y=[].concat(u(r),u(a),u(s),u(i));Array.isArray(x)&&allstylesInp.push.apply(x,y)}return{styles:x,addStyle:P}};function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}function p(e){var t,o;return(t="<Styles>").concat.apply(t,(o=e,function(e){if(Array.isArray(e))return m(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?m(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["</Styles>"]))}const d=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=f(o,!s),u=s?r(t,e,c.addStyle):i(t,e,l,c.addStyle,a,n),y='<?xml version="1.0"?>\n  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'.concat(e,'</Title></DocumentProperties>\n  <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>\n  <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n  <WindowHeight>').concat(u.height,"</WindowHeight>\n  <WindowWidth>").concat(u.width,"</WindowWidth>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n  </ExcelWorkbook>"),m=p(c.styles),d=y+m+u.xml+"</Workbook>";return d},h=function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],l=new ArrayBuffer(t.length),n=new Uint8Array(l),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([l],{type:o})},g=function(e,t,o,l,n,r){var a=d(e,t,o,l,n,r),s=new Buffer(a).toString("base64");return h("data:application/vnd.ms-excel;base64,"+s)},S=function(e,t,o){var l=d(e,t,{defaultStyle:o},null,null,null,!0),n=new Buffer(l).toString("base64");return h("data:application/vnd.ms-excel;base64,"+n)};return t})()}));