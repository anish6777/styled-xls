!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["styled-xls"]=t():e["styled-xls"]=t()}(global,(function(){return(()=>{"use strict";var e={d:(t,o)=>{for(var l in o)e.o(o,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:o[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e.r(t),e.d(t,{createBook:()=>p,createFromObjectArray:()=>m});const l=function(e,t,l){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;console.log("currentRow",e,"rowSpan",r);for(var n="<Row>",s=0;s<e.length;s++){var a=e[s],c=(new Date).getTime();if(console.log("currentColumn",a),a.style&&l(c,a.style),"object"!==o(a)||Array.isArray(a)||null===a)"string"==typeof a?(n+='<Cell ss:MergeDown="'+(r||"0")+'" ss:StyleID="'+t+'"><Data ss:Type="String">',n+=a,n+="</Data></Cell>"):"number"==typeof a&&(n+='<Cell ss:MergeDown="'+(r||"0")+'" ss:StyleID="'+t+(a%1==0?"int":"float")+'"><Data ss:Type="Number">',n+=a,n+="</Data></Cell>");else{var i=a.element;a.type?(console.log("currentColumn",a,"currentColumn.rowSpan",a.rowSpan,"rowSpan",r),"formula"==a.type?n+='<Cell ss:MergeDown="'+(a.rowSpan||r||"0")+'" ss:MergeAcross="'+(a.columnSpan||"0")+'" ss:StyleID="'+(a.style?c:t)+a.outputType+'" ss:Formula="'+(i||a.formula||"")+'"><Data ss:Type="Formula">':"float"==a.type?(n+='<Cell ss:MergeDown="'+(a.rowSpan||r||"0")+'" ss:MergeAcross="'+(a.columnSpan||"0")+'" ss:StyleID="'+(a.style?c:t)+'float"><Data ss:Type="Number">',n+=i):"number"==a.type||"int"==a.type?(n+='<Cell ss:MergeDown="'+(a.rowSpan||r||"0")+'" ss:MergeAcross="'+(a.columnSpan||"0")+'" ss:StyleID="'+(a.style?c:t)+'int"><Data ss:Type="Number">',n+=i):(n+='<Cell ss:MergeDown="'+(a.rowSpan||r||"0")+'" ss:MergeAcross="'+(a.columnSpan||"0")+'" ss:StyleID="'+(a.style?c:t)+'"><Data ss:Type="String">',n+=i),n+="</Data></Cell>"):"object"===o(a)&&(console.log("currentColumn object",a),n+='<Cell ss:MergeDown="'+(a.rowSpan||r||"0")+'" ss:MergeAcross="'+(a.columnSpan||"0")+'" ss:StyleID="'+(a.style?c:t)+'"><Data ss:Type="String">',n+=i,n+="</Data></Cell>",console.log("rowXml",n))}}n+="</Row>";for(var u=0;u<r;u++)n+="<Row>",n+="</Row>";return n};var r='</Table>\n<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n<PageLayoutZoom>0</PageLayoutZoom>\n<Selected/>\n<Panes>\n<Pane>\n<Number>3</Number>\n<ActiveRow>2</ActiveRow>\n</Pane>\n</Panes>\n<ProtectObjects>False</ProtectObjects>\n<ProtectScenarios>False</ProtectScenarios>\n</WorksheetOptions>\n</Worksheet>';const n=function(e,t,o){var n="",s=0,a=0;if(e&&Array.isArray(e)&&e.length>0){var c=e[0];s=c.length;for(var i=0;i<c.length;i++){var u=c[i];console.log("i",i),u&&(a+=90,console.log("totalWidth",a),n+='<Column ss:AutoFitWidth="1" ss:Width="90" />')}}for(var y={height:9e3,width:Math.floor(30*a)+50},f=e.length+2,m=worksheetHeader(t,s,f,n),p=0;p<e.length;p++){console.log("row",p);var d=p%2==1?"zebra":"default",g=e[p];g.style&&o("row"+p,g.style),m+=g&&g.elements?l(g.elements,g.style?"row"+p:d,o,g.rowSpan):l(g,d)}return y.xml=m+r,y},s=function(e,t,o){var l="<Row>";if(t)for(var r=0;r<t.length;r++){var n=t[r],s=e[n.key];n.type&&("formula"==n.type?l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+n.outputType+'" ss:Formula="'+(s||n.formula||"")+'"><Data ss:Type="Formula">':"float"==n.type?(l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'float"><Data ss:Type="Number">',l+=s):"number"==n.type||"int"==n.type?(l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'int"><Data ss:Type="Number">',l+=s):(l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'"><Data ss:Type="String">',l+=s),l+="</Data></Cell>")}else for(var a=Object.keys(e),c=0;c<a.length;c++){var i=e[a[c]];"number"==typeof i?(l+='<Cell ss:StyleID="'+o+(i%1==0?"int":"float")+'"><Data ss:Type="Number">',l+=i,l+="</Data></Cell>"):(l+='<Cell ss:StyleID="'+o+'"><Data ss:Type="String">',l+=i,l+="</Data></Cell>")}return l+"</Row>"};function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}const c=function(e,t,o,n,c,i){var u='<Row ss:AutoFitHeight="1">',y=0,f=0,m="";if(o){y=o.length;for(var p=0;p<o.length;p++){var d=o[p];if(console.log("i",p),console.log("currentHeader",d),d){var g=d.width;f+=g,console.log("totalWidth",f),d.headerStyle&&n((d.key||"")+"ColumnHeader",d.headerStyle),d.columnStyle&&n((d.key||"")+"ColumnCell",d.columnStyle),""===d.displayName?y--:(m+='<Column ss:AutoFitWidth="1" ss:Width="'+g+'" />',u+='<Cell ss:StyleID="'.concat(d.headerStyle?(d.key||"")+"ColumnHeader":"headercell",'">')+'<Data ss:Type="String">'+d.displayName+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}}else if(e&&Array.isArray(e)&&e.length>0){for(var S=Object.keys(e[0]),h=0;h<S.length;h++){var b=S[h];console.log("i",h),b&&(f+=90,console.log("totalWidth",f),m+='<Column ss:AutoFitWidth="1" ss:Width="90" />',u+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+b+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}console.log("keys",S)}u+="</Row>",Array.isArray(i)&&i.forEach((function(e,t){if("object"===a(e)){var o=e.style;n("firstRow"+t,o);var r=l(e.elements,e.style?"firstRow"+t:"default",n);u=r+u}else{var s=l(e,"default",n);u=s+u}}));for(var w={height:9e3,width:Math.floor(30*f)+50},v=e.length+2,D=worksheetHeader(t,y,v,m,u),C=0;C<e.length;C++){console.log("row",C);var A=C%2==1?"zebra":"default",x=e[C];D+=s(x,o,A)}if(c&&c.elements){var T=c.style;n("lastRow",T),D+=l(c.elements,c.style?"lastRow":"default",n)}return console.log("t",D),w.xml=D+r,w};function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}function u(e){var t,o;return(t="<Styles>").concat.apply(t,(o=e,function(e){if(Array.isArray(e))return i(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?i(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["</Styles>"]))}const y=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=Styles(o,!a),y=a?n(t,e,i.addStyle):c(t,e,l,i.addStyle,s,r),f='<?xml version="1.0"?>\n  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'.concat(e,'</Title></DocumentProperties>\n  <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>\n  <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n  <WindowHeight>').concat(y.height,"</WindowHeight>\n  <WindowWidth>").concat(y.width,"</WindowWidth>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n  </ExcelWorkbook>"),m=u(i.styles),p=f+m+y.xml+"</Workbook>";return p},f=function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],l=new ArrayBuffer(t.length),r=new Uint8Array(l),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return new Blob([l],{type:o})},m=function(e,t,o,l,r,n){var s=y(e,t,o,l,r,n),a=new Buffer(s).toString("base64");return f("data:application/vnd.ms-excel;base64,"+a)},p=function(e,t,o){var l=y(e,t,{defaultStyle:o},null,null,null,!0),r=new Buffer(l).toString("base64");return f("data:application/vnd.ms-excel;base64,"+r)};return t})()}));