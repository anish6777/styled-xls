!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["styled-xls"]=t():e["styled-xls"]=t()}(global,(function(){return(()=>{"use strict";var e={d:(t,o)=>{for(var l in o)e.o(o,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:o[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}e.r(t),e.d(t,{createBook:()=>S,createFromObjectArray:()=>g});const l=function(e,t,l){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;console.log("currentRow",e,"rowSpan",r);for(var n="<Row>",a=0;a<e.length;a++){var s=e[a],i=(new Date).getTime();if(console.log("currentColumn",s),s.style&&l(i,s.style),"object"!==o(s)||Array.isArray(s)||null===s)"string"==typeof s?(n+='<Cell ss:MergeDown="'+(r||"0")+'" ss:StyleID="'+t+'"><Data ss:Type="String">',n+=s,n+="</Data></Cell>"):"number"==typeof s&&(n+='<Cell ss:MergeDown="'+(r||"0")+'" ss:StyleID="'+t+(s%1==0?"int":"float")+'"><Data ss:Type="Number">',n+=s,n+="</Data></Cell>");else{var c=s.element;s.type?(console.log("currentColumn",s,"currentColumn.rowSpan",s.rowSpan,"rowSpan",r),"formula"==s.type?n+='<Cell ss:MergeDown="'+(s.rowSpan||r||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+s.outputType+'" ss:Formula="'+(c||s.formula||"")+'"><Data ss:Type="Formula">':"float"==s.type?(n+='<Cell ss:MergeDown="'+(s.rowSpan||r||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'float"><Data ss:Type="Number">',n+=c):"number"==s.type||"int"==s.type?(n+='<Cell ss:MergeDown="'+(s.rowSpan||r||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'int"><Data ss:Type="Number">',n+=c):(n+='<Cell ss:MergeDown="'+(s.rowSpan||r||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',n+=c),n+="</Data></Cell>"):"object"===o(s)&&(console.log("currentColumn object",s),n+='<Cell ss:MergeDown="'+(s.rowSpan||r||"0")+'" ss:MergeAcross="'+(s.columnSpan||"0")+'" ss:StyleID="'+(s.style?i:t)+'"><Data ss:Type="String">',n+=c,n+="</Data></Cell>",console.log("rowXml",n))}}n+="</Row>";for(var u=0;u<r;u++)n+="<Row>",n+="</Row>";return n},r=function(e,t,o,l,r){var n='<Worksheet ss:Name="'.concat(e,'">\n  <Names>\n  <NamedRange ss:Name="Sheet_Titles" ss:RefersTo="=\'').concat(e,'\'!R1:R2">\n  </NamedRange></Names>\n  <Table ss:ExpandedColumnCount="').concat(t+2,'" ss:ExpandedRowCount="').concat(o,'" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="80" ss:DefaultRowHeight="15">\n  ').concat(l);return r&&(n+=r),n};var n='</Table>\n<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\n<PageLayoutZoom>0</PageLayoutZoom>\n<Selected/>\n<Panes>\n<Pane>\n<Number>3</Number>\n<ActiveRow>2</ActiveRow>\n</Pane>\n</Panes>\n<ProtectObjects>False</ProtectObjects>\n<ProtectScenarios>False</ProtectScenarios>\n</WorksheetOptions>\n</Worksheet>';const a=function(e,t,o){var a="",s=0,i=0;if(e&&Array.isArray(e)&&e.length>0){var c=e[0];s=c.length;for(var u=0;u<c.length;u++){var f=c[u];console.log("i",u),f&&(i+=90,console.log("totalWidth",i),a+='<Column ss:AutoFitWidth="1" ss:Width="90" />')}}for(var y={height:9e3,width:Math.floor(30*i)+50},m=e.length+2,d=r(t,s,m,a),p=0;p<e.length;p++){console.log("row",p);var h=p%2==1?"zebra":"default",g=e[p];g.style&&o("row"+p,g.style),d+=g&&g.elements?l(g.elements,g.style?"row"+p:h,o,g.rowSpan):l(g,h)}return y.xml=d+n,y},s=function(e,t,o){var l="<Row>";if(t)for(var r=0;r<t.length;r++){var n=t[r],a=e[n.key];n.type&&("formula"==n.type?l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+n.outputType+'" ss:Formula="'+(a||n.formula||"")+'"><Data ss:Type="Formula">':"float"==n.type?(l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'float"><Data ss:Type="Number">',l+=a):"number"==n.type||"int"==n.type?(l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'int"><Data ss:Type="Number">',l+=a):(l+='<Cell ss:StyleID="'+(n.columnStyle?(n.key||"")+"ColumnCell":o)+'"><Data ss:Type="String">',l+=a),l+="</Data></Cell>")}else for(var s=Object.keys(e),i=0;i<s.length;i++){var c=e[s[i]];"number"==typeof c?(l+='<Cell ss:StyleID="'+o+(c%1==0?"int":"float")+'"><Data ss:Type="Number">',l+=c,l+="</Data></Cell>"):(l+='<Cell ss:StyleID="'+o+'"><Data ss:Type="String">',l+=c,l+="</Data></Cell>")}return l+"</Row>"};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}const c=function(e,t,o,a,c,u){var f='<Row ss:AutoFitHeight="1">',y=0,m=0,d="";if(o){y=o.length;for(var p=0;p<o.length;p++){var h=o[p];if(console.log("i",p),console.log("currentHeader",h),h){var g=h.width;m+=g,console.log("totalWidth",m),h.headerStyle&&a((h.key||"")+"ColumnHeader",h.headerStyle),h.columnStyle&&a((h.key||"")+"ColumnCell",h.columnStyle),""===h.displayName?y--:(d+='<Column ss:AutoFitWidth="1" ss:Width="'+g+'" />',f+='<Cell ss:StyleID="'.concat(h.headerStyle?(h.key||"")+"ColumnHeader":"headercell",'">')+'<Data ss:Type="String">'+h.displayName+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}}}else if(e&&Array.isArray(e)&&e.length>0){for(var S=Object.keys(e[0]),b=0;b<S.length;b++){var v=S[b];console.log("i",b),v&&(m+=90,console.log("totalWidth",m),d+='<Column ss:AutoFitWidth="1" ss:Width="90" />',f+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+v+'</Data><NamedCell ss:Name="Header_Texts"></NamedCell></Cell>')}console.log("keys",S)}f+="</Row>",Array.isArray(u)&&u.forEach((function(e,t){if("object"===i(e)){var o=e.style;a("firstRow"+t,o);var r=l(e.elements,e.style?"firstRow"+t:"default",a);f=r+f}else{var n=l(e,"default",a);f=n+f}}));for(var w={height:9e3,width:Math.floor(30*m)+50},C=e.length+2,D=r(t,y,C,d,f),A=0;A<e.length;A++){console.log("row",A);var T=A%2==1?"zebra":"default",x=e[A];D+=s(x,o,T)}if(c&&c.elements){var W=c.style;a("lastRow",W),D+=l(c.elements,c.style?"lastRow":"default",a)}return console.log("t",D),w.xml=D+n,w},u=function(e,t,o,l,r,n,a,s,i){var c,u,f,y,m,d,p,h,g,S,b=[];if(b.push('<Style ss:ID="'.concat(e,'" ').concat(t?'ss:Parent="'+t+'"':"").concat(i?' ss:Name="'+i+'"':"",">")),r){var v=function(e){return"<Numberformat".concat(void 0===e||"empty"===e?"":' ss:Format="'+e+'"',"/>")}(r);b.push(v)}if(o){var w=(c=o.name,u=o.family,f=o.weight,y=o.size,m=o.color,"<Font ".concat(void 0===c?"":' ss:FontName="'+(c||"Calibri")+'"').concat(void 0===u?"":' x:Family="'+(u||"Swiss")+'"').concat(void 0===f?"":' ss:Bold="'+(f||"0")+'"').concat(void 0===y?"":' ss:Size="'+(y||"10")+'"').concat(void 0===m?"":' ss:Color="'+(m||"ffffff")+'"',"/>"));b.push(w)}if(a){var C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Left","Right","Bottom","Top"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("borderStyles",t);var l=[];return l.push("<Borders>"),e&&Array.isArray(e)&&e.forEach((function(e){l.push('<Border ss:Position="'.concat(e,'" ss:LineStyle="Continuous"  ss:Color="').concat(t[e]&&t[e].color||t.color||o.color||"#ffffff",'" ss:Weight="').concat(t[e]&&t[e].weight||t.weight||o.weight||"1",'"/>'))})),l.push("</Borders>"),l}(a.type,a.styles);b.push.apply(b,C)}if(n){var D=(d=n.vertical,p=n.horizontal,h=n.wrapText,"<Alignment".concat(void 0===d?"":' ss:Vertical="'+(d||"Center")+'"').concat(void 0===p?"":' ss:Horizontal="'+(p||"Center")+'"').concat(void 0===h?"":' ss:WrapText="'+(h||"1")+'"',"/>"));b.push(D)}if(l){var A=(g=l.color,S=l.pattern,"<Interior".concat(void 0===g?"":' ss:Color="'+(g||"#ffffff")+'"').concat(void 0===S?"":' ss:Pattern="'+(S||"Solid")+'"',"/>"));b.push(A)}if(s){b.push("<Protection/>")}return b.push("</Style>"),b};function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}const m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{defaultStyle:{},headerStyle:{}},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o={name:e.defaultStyle.fontName,family:e.defaultStyle.fontFamily,weight:e.defaultStyle.fontWeight,size:e.defaultStyle.fontSize,color:e.defaultStyle.fontColor},l={weight:"1",size:"18"},r={name:"Calibri",family:"Swiss",color:"#000000",size:"12"},n={color:e.alternateRowColor||e.defaultStyle.backgroundColor,pattern:"Solid"},a={color:e.defaultStyle.backgroundColor,pattern:"Solid"},s={},i={vertical:"Center",horizontal:"Center",wrapText:"1"},c={color:"#D3D3D3"},y={vertical:"Bottom"},m={type:[]},d={type:["Top","Bottom","Right","Left"],styles:{color:e.defaultStyle.borderColor||"#000000"}},p=u("defaultint","default",null,null,"0"),h=u("defaultfloat","default",null,null,"0.00"),g=u("defaultdate","default",null,null,"yyyy-mm-dd"),S=u("zebraint","zebra",null,null,"0"),b=u("zebrafloat","zebra",null,null,"0.00"),v=u("zebradate","zebra",null,null,"yyyy-mm-dd"),w=u("zebra",null,o,n,null,null,d),C=u("default",null,o,a,null,null,d),D=u("groupSeparator",null,null,c),A=u("title",null,l,s,"@",i,m),T=u("Default",null,r,s,"empty",y,m,!0,"Normal"),x=[].concat(f(T),f(T),f(A),f(C),f(g),f(p),f(h),f(w),f(D),f(v),f(S),f(b));if(t){var W={type:["Top","Bottom","Right"],styles:{color:"#00FF00",Top:{color:"#FF0000",weight:"100"}}},N={name:e.headerStyle.fontName,family:e.headerStyle.fontFamily,weight:e.headerStyle.fontWeight,size:e.headerStyle.fontSize,color:e.headerStyle.fontColor},R={color:e.headerStyle.backgroundColor||"#A3C9F1",pattern:"Solid"},k={horizontal:e.headerStyle.horizontalAlignment||"Center",wrapText:e.headerStyle.wrapText||"1"},F=u("headercell",null,N,R,null,k,W);x.push.apply(x,F)}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o={name:t.fontName,family:t.fontFamily,weight:t.fontWeight,size:t.fontSize,color:t.color||t.fontColor},l={color:t.backgroundColor||"#A3C9F1",pattern:t.pattern||"Solid"},r={type:["Top","Bottom","Right","Left"],styles:{color:t.borderColor||"#000000"}},n={vertical:t.verticalAlignment,horizontal:t.horizontalAlignment,wrapText:t.wrapText},a=u(e,null,o,l,null,n,r),s=u(e+"int",e,null,null,"0"),i=u(e+"float",e,null,null,"0.00"),c=u(e+"date",e,null,null,"yyyy-mm-dd"),y=[].concat(f(a),f(s),f(i),f(c));Array.isArray(x)&&x.push.apply(x,y)}return{styles:x,addStyle:z}};function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=e[o];return l}function p(e){var t,o;return(t="<Styles>").concat.apply(t,(o=e,function(e){if(Array.isArray(e))return d(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?d(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat(["</Styles>"]))}const h=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=m(o,!s),u=s?a(t,e,i.addStyle):c(t,e,l,i.addStyle,n,r),f='<?xml version="1.0"?>\n  <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">\n  <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'.concat(e,'</Title></DocumentProperties>\n  <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>\n  <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\n  <WindowHeight>').concat(u.height,"</WindowHeight>\n  <WindowWidth>").concat(u.width,"</WindowWidth>\n  <ProtectStructure>False</ProtectStructure>\n  <ProtectWindows>False</ProtectWindows>\n  </ExcelWorkbook>"),y=p(i.styles),d=f+y+u.xml+"</Workbook>";return d},g=function(e,t,o,l,r,n){var a=h(e,t,o,l,r,n);return"data:application/vnd.ms-excel;base64,"+Buffer.from(a).toString("base64")},S=function(e,t,o){var l=h(e,t,{defaultStyle:o},null,null,null,!0);return function(e){for(var t=atob(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],l=new ArrayBuffer(t.length),r=new Uint8Array(l),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return new Blob([l],{type:o})}("data:application/vnd.ms-excel;base64,"+new Buffer(l).toString("base64"))};return t})()}));